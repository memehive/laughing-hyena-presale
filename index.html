<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Upgrade insecure requests -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Laughing Hyena Presale</title>

  <!-- SEO, Open Graph, Twitter Meta Tags (adjust as needed) -->
  <meta name="description" content="Join the $LHyena presale and experience crypto with a twist!" />
  <meta property="og:title" content="Laughing Hyena - $LHyena Presale" />
  <meta property="og:description" content="Join our presale and buy $LHyena tokens with ETH." />
  <meta property="og:image" content="https://gateway.pinata.cloud/ipfs/bafybeifvoit5z7zcwgqgkd5mf65gvktzstdsztbavsvm5x3alliyfugrwu" />
  <meta property="og:url" content="https://memehive.click/lhyena" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Fredoka+One&family=Lexend+Zetta&family=Raleway+Dots&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <!-- Bootstrap Icons (if needed) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js" defer></script>
  <script src="https://unpkg.com/@coinbase/wallet-sdk/dist/wallet-sdk.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.8/dist/index.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" defer></script>

  <!-- Merged Styles (Visual Style from Attached Website) -->
  <style>
    /* --- CSS Variables & Global Settings --- */
    :root {
      --primary-blue: #0A192F;
      --light-gray: #112240;
      --container-bg: #1A2A40;
      --accent-cyan: #64FFDA;
      --golden-yellow: #F9A826;
      --purple: rgba(149, 86, 255, 0.8);
      --primary-text: #CCD6F6;
      --secondary-accent: #D81B60;
    }
    
    /* Falling Code Animation Background (optional) */
    #falling-code {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      pointer-events: none;
      background: var(--primary-blue);
    }
    
    /* Global resets and typography */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Roboto Mono', monospace;
      background-color: var(--primary-blue);
      color: var(--primary-text);
      line-height: 1.6;
      /* Center the main container (optional) */
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .main-container { max-width: 1200px; width: 100%; }
    
    /* --- Header Section --- */
    header {
      background: var(--light-gray);
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      /* Use the slide-down animation from attached code */
      animation: slideDown 0.8s ease-out forwards;
    }
    @keyframes slideDown { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    
    .header-bottom {
      display: flex;
      align-items: center;
      padding: 1.25rem;
    }
    .header-left {
      display: flex;
      align-items: center;
    }
    .logo {
      width: 100px; 
      margin-right: 1rem;
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .header-left:hover .logo { transform: rotateY(20deg); }
    /* Header text styles */
    .header-left h1 {
      font-family: 'Bangers', cursive;
      font-size: 48px;
      color: #ffffff;
      text-shadow: 2px 2px 4px var(--purple);
    }
    .header-left p.tagline {
      font-family: 'Raleway Dots', sans-serif;
      font-size: 24px;
      font-weight: bold;
      color: var(--golden-yellow);
      margin-top: 0.5rem;
      text-shadow: 1px 1px 3px var(--purple);
    }
    
    /* Navigation (keep original function, style similar to attached code) */
    .header-nav {
      padding: 0.75rem 1.25rem;
      border-top: 1px solid var(--accent-cyan);
    }
    .header-nav nav ul {
      display: flex;
      list-style: none;
      justify-content: flex-end;
    }
    .header-nav nav ul li { margin: 0 0.625rem; }
    .header-nav nav ul li a {
      color: var(--primary-text);
      text-decoration: none;
      font-size: 1rem;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      transition: transform 0.3s, box-shadow 0.3s, color 0.3s;
    }
    .header-nav nav ul li a:hover,
    .header-nav nav ul li a.active {
      transform: scale(1.1) perspective(500px) rotateX(-15deg) rotateY(15deg);
      font-weight: bold;
      background: var(--accent-cyan);
      color: var(--primary-blue);
      box-shadow: 0px 4px 8px rgba(0,0,0,0.5);
    }
    
    /* --- Main Presale Content (Preserving Functionality) --- */
    /* You can wrap your presale controls inside a section with the .container class */
    .presale-container {
      padding: 1.875rem;
      background: var(--container-bg);
      margin: 2rem 0;
      border-radius: 0.5rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      width: 90%;
      max-width: 600px;
    }
    .presale-container h2 {
      font-family: 'Raleway Dots', sans-serif;
      font-size: 2.5rem;
      color: var(--accent-cyan);
      margin-bottom: 1rem;
      text-align: center;
    }
    .input-container {
      margin: 1rem auto;
      text-align: left;
      width: 130px;
    }
    .input-label {
      font-size: 0.8rem;
      margin-bottom: 0.25rem;
    }
    input[type="number"] {
      width: 100%;
      height: 40px;
      font-size: 1rem;
      text-align: center;
    }
    .wallet-buttons-container,
    .buy-button {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin: 1rem auto;
    }
    .wallet-button, .buy-button {
      background: linear-gradient(to bottom, var(--accent-cyan), var(--golden-yellow));
      color: var(--primary-blue);
      font-weight: bold;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      cursor: pointer;
      border: 2px solid #000;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 4px 0 #000;
    }
    .wallet-button:hover, .buy-button:hover {
      transform: translateY(2px) scale(1.05);
      box-shadow: 0 6px 10px rgba(0,0,0,0.2);
    }
    .token-receive {
      font-family: 'Fredoka One', sans-serif;
      font-size: 1.2rem;
      color: var(--golden-yellow);
      text-align: center;
      margin-top: 1rem;
    }
    
    /* --- Footer --- */
    footer {
      background: var(--light-gray);
      color: var(--primary-text);
      text-align: center;
      padding: 1.25rem 0;
      margin-top: 2rem;
    }
    
    /* --- Responsive Adjustments --- */
    @media (max-width: 768px) {
      .main-container { padding: 0 1rem; }
      .header-nav nav ul { flex-direction: column; align-items: flex-end; }
      .header-nav nav ul li { margin: 0.3125rem 0; }
      .presale-container { width: 100%; }
    }
  </style>
</head>
<body>
  <!-- Falling Code Animation Background (Optional; remove if not desired) -->
  <canvas id="falling-code"></canvas>
  
  <div class="main-container">
    <!-- Header Section (Styled like the attached site) -->
    <header>
      <div class="header-bottom">
        <div class="header-left">
          <img src="https://gateway.pinata.cloud/ipfs/bafybeifvoit5z7zcwgqgkd5mf65gvktzstdsztbavsvm5x3alliyfugrwu" alt="Laughing Hyena Logo" class="logo" loading="lazy">
          <div>
            <h1>Laughing Hyena</h1>
            <p class="tagline">Pack Mentality Pays!</p>
          </div>
        </div>
      </div>
      <div class="header-nav">
        <nav role="navigation" aria-label="Main Navigation">
          <ul>
            <li><a href="#home">Home</a></li>
            <!-- You can add more navigation links here if desired -->
          </ul>
        </nav>
      </div>
    </header>
    
    <!-- Presale Content Section (Functionality preserved) -->
    <section id="home" class="presale-container">
      <h2>$LHyena Presale</h2>
      <div id="progress-bar">0%</div>
      <p>Total ETH raised: <span id="ethRaised">0</span> ETH</p>
      <p>Your Contribution: <span id="userContribution">0</span> ETH</p>
      <p>Hardcap: 50 ETH | Softcap: 25 ETH | Token Rate: 20,000,000 LHyena/ETH</p>
      <p>Vesting: 25% monthly for 4 months</p>
      <p style="font-size:0.8rem; color: #ff5555; text-align:center;">Warning: Do not send funds directly to the presale contract address.</p>
      <div class="input-container">
        <label class="input-label" for="ethAmount">Enter ETH:</label>
        <input type="number" id="ethAmount" placeholder="ETH (Max 5)" min="0.001" max="5" step="0.01" onblur="validateEthAmount(); calculateTokens()">
      </div>
      <div class="input-container">
        <label class="input-label" for="lhyenaAmount">Enter $LHyena:</label>
        <input type="number" id="lhyenaAmount" placeholder="$LHyena" min="0" step="any" onblur="convertLHyenaToETH();">
      </div>
      <p class="token-receive">You will receive: <span id="tokenAmount">0</span> LHyena</p>
      <div class="wallet-buttons-container">
        <button id="connectCoinbaseWallet" class="wallet-button" onclick="connectCoinbaseWallet()" aria-label="Connect Coinbase Wallet">
          <i class="bi bi-wallet2"></i> Coinbase
        </button>
        <button id="disconnectWallet" class="wallet-button" onclick="disconnectWallet()" aria-label="Disconnect Wallet">
          <i class="bi bi-x-circle"></i> Disconnect
        </button>
      </div>
      <div style="margin-top:1rem;">
        <button id="buyTokensButton" class="buy-button" onclick="promptBuyTokens()" aria-label="Buy Tokens">
          <i class="bi bi-cart-check"></i> BUY
        </button>
      </div>
    </section>
    
    <!-- Footer Section -->
    <footer>
      <p>&copy; 2025 Laughing Hyena. All Rights Reserved.</p>
    </footer>
  </div>
  
  <!-- Falling Code Animation Script (Optional) -->
  <script>
    // Adapted from your attached code
    const canvas = document.getElementById('falling-code');
    const ctxCode = canvas.getContext('2d');
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    const fontSize = 8;
    const columns = Math.floor(canvas.width / fontSize);
    const drops = [];
    const wordSet = ["$LHyena", "Crypto", "Laughing Hyena", "2025", "BASE", "Ethereum"];
    const currentWord = [];
    for (let i = 0; i < columns; i++) {
      drops[i] = Math.random() * canvas.height / fontSize;
      currentWord[i] = wordSet[Math.floor(Math.random() * wordSet.length)];
    }
    const speed = 0.1;
    const letterSpacing = 2;
    function fillTextWithSpacing(ctx, text, x, y, spacing) {
      spacing = spacing || 2;
      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        ctx.fillText(char, x, y);
        x += ctx.measureText(char).width + spacing;
      }
    }
    function draw() {
      ctxCode.fillStyle = "rgba(10, 25, 47, 0.1)";
      ctxCode.fillRect(0, 0, canvas.width, canvas.height);
      ctxCode.fillStyle = "#64FFDA";
      ctxCode.font = fontSize + "px 'Lexend Zetta', monospace";
      ctxCode.shadowColor = "#000";
      ctxCode.shadowBlur = 3;
      for (let i = 0; i < drops.length; i++) {
        const text = currentWord[i];
        const yPos = Math.floor(drops[i]) * fontSize;
        fillTextWithSpacing(ctxCode, text, i * fontSize, yPos, letterSpacing);
        if (yPos > canvas.height && Math.random() > 0.975) {
          drops[i] = 0;
          currentWord[i] = wordSet[Math.floor(Math.random() * wordSet.length)];
        }
        drops[i] += speed;
      }
    }
    setInterval(draw, 100);
  </script>
  
  <!-- Presale Website Functionality Script (Unchanged) -->
  <script>
    window.addEventListener('load', function () {
      // Global variables and constants
      let walletBalanceRaw = 0;
      let disconnectTimer = null;
      const BASE_CHAIN_ID_DEC = 8453;
      const BASECHAIN_RPC_URL = "https://base-mainnet.infura.io/v3/e923b24ca7eb4da7aa7e827ccae39ef9";
      const PRESALE_CONTRACT_ADDRESS = "0xc9beD6d7ecb7A1ea7F064A41971549FC4ee6CD20";
      const TOKEN_RATE = 20000000;
      
      function truncateAddress(address) {
        return address ? address.slice(0, 6) + "....." + address.slice(-4) : "";
      }
      
      let provider, signer, userAddress = "";
      
      const Web3ModalConstructor = (window.Web3Modal && window.Web3Modal.default) || window.Web3Modal;
      if (!Web3ModalConstructor) {
        console.error("Web3Modal constructor not found.");
        return;
      }
      window.web3Modal = new Web3ModalConstructor({
        cacheProvider: false,
        providerOptions: {
          coinbasewallet: {
            package: window.CoinbaseWalletSDK,
            options: {
              appName: "Laughing Hyena Presale",
              rpc: BASECHAIN_RPC_URL,
              chainId: BASE_CHAIN_ID_DEC,
              darkMode: false
            }
          }
        }
      });
      
      window.connectCoinbaseWallet = async function() {
        if (!window.ethereum) {
          alert("Coinbase Wallet not detected. Install wallet.");
          return;
        }
        window.web3Modal.clearCachedProvider();
        try {
          const instance = await window.web3Modal.connectTo("coinbasewallet");
          provider = new ethers.providers.Web3Provider(instance);
          await provider.send("eth_requestAccounts", []);
          const { chainId } = await provider.getNetwork();
          if (chainId !== BASE_CHAIN_ID_DEC) {
            alert("Please connect to Basechain using Coinbase Wallet.");
            return;
          }
          signer = provider.getSigner();
          userAddress = await signer.getAddress();
          updateWalletStatus();
          await fetchWalletBalance();
          disconnectTimer = setTimeout(() => {
            alert("Your Coinbase wallet connection has timed out.");
            disconnectWallet();
          }, 600000);
        } catch (error) {
          alert("Wallet connection failed: " + error.message);
        }
      };
      
      window.disconnectWallet = async function() {
        if (!provider || userAddress === "") {
          alert("No wallet connected.");
          return;
        }
        if (provider.disconnect) await provider.disconnect();
        provider = signer = "";
        userAddress = "";
        updateStatus("Not connected", "negative");
        document.getElementById("ethAmount").value = "";
        document.getElementById("lhyenaAmount").value = "";
        if (disconnectTimer) clearTimeout(disconnectTimer);
      };
      
      window.validateEthAmount = function() {
        const ethInput = document.getElementById("ethAmount");
        let ethAmount = parseFloat(ethInput.value);
        if (isNaN(ethAmount)) { updateStatus("Please enter a valid ETH amount.", "negative"); return; }
        if (ethAmount < 0.001) { ethInput.value = "0.001"; updateStatus("Minimum contribution is 0.001 ETH", "negative"); return; }
        if (ethAmount > 5) { ethInput.value = "5"; updateStatus("Maximum contribution is 5 ETH", "negative"); return; }
        if (userAddress && ethAmount > walletBalanceRaw) { ethInput.value = walletBalanceRaw.toFixed(5); updateStatus("Amount reset to wallet balance", "negative"); return; }
        updateWalletStatus();
      };
      
      window.convertLHyenaToETH = function() {
        const lhyenaInput = document.getElementById("lhyenaAmount");
        let lhyenaVal = parseFloat(lhyenaInput.value);
        if (isNaN(lhyenaVal)) return;
        let ethRequired = lhyenaVal / TOKEN_RATE;
        if (ethRequired > 5) { ethRequired = 5; lhyenaInput.value = (5 * TOKEN_RATE).toFixed(2); }
        document.getElementById("ethAmount").value = ethRequired.toFixed(2);
        calculateTokens();
      };
      
      window.calculateTokens = function() {
        let ethAmount = parseFloat(document.getElementById("ethAmount").value) || 0;
        const lhyenaAmount = ethAmount * TOKEN_RATE;
        document.getElementById("tokenAmount").innerText = lhyenaAmount.toLocaleString();
        document.getElementById("lhyenaAmount").value = lhyenaAmount.toFixed(2);
      };
      
      function updateWalletStatus() {
        if (userAddress) {
          const statusEl = document.getElementById("status");
          statusEl.innerText = "Connected: " + truncateAddress(userAddress) + " | Balance: " + walletBalanceRaw.toFixed(5) + " ETH";
          statusEl.className = "status-positive";
        }
      }
      
      function updateStatus(message, type) {
        const statusEl = document.getElementById("status");
        statusEl.innerText = message;
        statusEl.className = type === "positive" ? "status-positive" : "status-negative";
      }
      
      async function fetchWalletBalance() {
        if (!provider || !userAddress) return;
        try {
          const balance = await provider.getBalance(userAddress);
          walletBalanceRaw = parseFloat(ethers.utils.formatEther(balance));
          updateWalletStatus();
        } catch (err) { console.error("Error fetching wallet balance:", err); }
      }
      
      // Update presale progress from the contract (if available)
      async function fetchPresaleProgress() {
        if (!provider) return;
        try {
          const contract = new ethers.Contract(
            PRESALE_CONTRACT_ADDRESS,
            [{
              "inputs": [],
              "name": "totalRaised",
              "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
              "stateMutability": "view",
              "type": "function"
            }],
            provider
          );
          const ethRaised = await contract.totalRaised();
          const ethRaisedFormatted = ethers.utils.formatEther(ethRaised);
          document.getElementById("ethRaised").innerText = ethRaisedFormatted + " ETH";
          document.getElementById("progress-bar").innerText = Math.min((ethRaisedFormatted / 50) * 100, 100).toFixed(0) + '%';
        } catch (error) { console.error("Error fetching presale progress:", error); }
      }
      
      setInterval(fetchPresaleProgress, 5000);
      setInterval(fetchWalletBalance, 10000);
      
      window.promptBuyTokens = async function() {
        if (!signer) { alert("Please connect your wallet first!"); return; }
        validateEthAmount();
        const ethAmount = parseFloat(document.getElementById("ethAmount").value);
        if (isNaN(ethAmount)) { updateStatus("Please enter a valid ETH amount.", "negative"); return; }
        try {
          const contract = new ethers.Contract(
            PRESALE_CONTRACT_ADDRESS,
            [{
              "inputs": [],
              "name": "buyTokens",
              "outputs": [],
              "stateMutability": "payable",
              "type": "function"
            }],
            signer
          );
          const tx = await contract.buyTokens({ value: ethers.utils.parseEther(ethAmount.toString()) });
          updateStatus("Transaction submitted. Waiting for confirmations...", "positive");
          await tx.wait(3);
          updateStatus("Transaction Successful! You have purchased $LHyena tokens.", "positive");
        } catch (error) {
          updateStatus("Transaction failed: " + error.message, "negative");
        }
      };
      
    });
  </script>
</body>
</html>
